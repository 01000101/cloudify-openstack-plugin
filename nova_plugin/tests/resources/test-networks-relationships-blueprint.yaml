
tosca_definitions_version: cloudify_dsl_1_2

imports:
  - http://www.getcloudify.org/spec/cloudify/3.3.1/types.yaml
  - plugin.yaml

inputs:
  management_network_name:
    type: string
    default: network1

node_templates:
  server:
    type: cloudify.openstack.nodes.Server
    properties:
      install_agent: false
      management_network_name: {get_input: management_network_name}
      server:
        key_name: key
        scheduler_hints:
          group: affinity-group-id
      openstack_config: &OPENSTACK_CONFIG
        username: aaa
        password: aaa
        tenant_name: aaa
        auth_url: aaa
    relationships:
      - target: network1
        type: cloudify.relationships.connected_to
      - target: network2
        type: cloudify.relationships.connected_to
      - target: network3
        type: cloudify.relationships.connected_to
      - target: network4
        type: cloudify.relationships.connected_to
      - target: network5
        type: cloudify.relationships.connected_to
      - target: network6
        type: cloudify.relationships.connected_to

  network1:
    type: cloudify.openstack.nodes.Network
    properties: &NETWORK_CONFIG
      use_external_resource: true
      resource_id: network1
      openstack_config: *OPENSTACK_CONFIG

  network2: 
    type: cloudify.openstack.nodes.Network
    properties:
      use_external_resource: true
      resource_id: network2
      openstack_config: *OPENSTACK_CONFIG

  network3: 
    type: cloudify.openstack.nodes.Network
    properties:
      use_external_resource: true
      resource_id: network3
      openstack_config: *OPENSTACK_CONFIG

  network4: 
    type: cloudify.openstack.nodes.Network
    properties:
      use_external_resource: true
      resource_id: network4
      openstack_config: *OPENSTACK_CONFIG

  network5: 
    type: cloudify.openstack.nodes.Network
    properties:
      use_external_resource: true
      resource_id: network5
      openstack_config: *OPENSTACK_CONFIG

  network6: 
    type: cloudify.openstack.nodes.Network
    properties:
      use_external_resource: true
      resource_id: network6
      openstack_config: *OPENSTACK_CONFIG
